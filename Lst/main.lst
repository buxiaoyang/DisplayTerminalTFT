C51 COMPILER V7.50   MAIN                                                                  02/15/2014 16:19:27 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Obj\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Src\main.c BROWSE INCDIR(.\Src) DEBUG OBJECTEXTEND PRINT(.\Lst\main.lst) OB
                    -JECT(.\Obj\main.obj)

line level    source

   1          //******************************************************************
   2          //  CPU:STC11L60XE
   3          //  CRY:11.0592Mhz
   4          //  LCM:s6d0154-2.6 TFT
   5          //  PCB:v1
   6          //  NAM:彩屏程序                                            20120906
   7          //******************************************************************
   8          //#include <REG54.H>
   9          //#include <reg51.h>
  10          #include "STC_NEW_8051.H"
  11          #define uchar unsigned char
  12          #define uint unsigned int
  13          
  14          #include "HEAD.H"
  15          
  16          //#include"init_tft.h"
  17          #include"s6d0154_drv.h"
  18          
  19          //---------------------------------
  20          #define T0_H 0xF8 //0xFC  1ms from 12MHz 998 to 24MHz 1998
  21          #define T0_L 0x32 //0x1A
  22          #define T1_H 0xfe
  23          #define T1_L 0x31
  24          #include <serial.h> //串口功能
  25          #include <SysTem.H>
  26          //****************************************************************
  27          //  延时1ms程序
  28          //****************************************************************
  29          //           fosc=12MHz;count=10;j=5, i=62; Keil uV2=9.977ms
  30          //STC12c4042:fosc=12Mhz;count=1; j=10,i=169;KEIL750 =1.000ms!!!不准!!!实际长了
  31          //STC12c5410AD:内置5.756373M;count=10;j=10,i=78;KEIL750=10.000ms!
  32          void Delay(unsigned int count)// delay=1ms*count 12MHz with 11L60XE
  33          {
  34   1          unsigned char i,j;
  35   1          while(count--!=0)
  36   1          {   for(j=0;j<10;j++)
  37   2                  {    for(i=0;i<168;i++);
  38   3      }   }   }
  39          //******************************************************************
  40          //  在TFT上显示字符
  41          //------------------------------------------------------------------
  42          void ViewTFT(void)
  43          {
  44   1          LCD_CS =0;  //打开片选使能
  45   1          //---------------------------------
  46   1          ChineseChar(14+46,10,2,colors[2],colors[7],1);      //晶
  47   1          ChineseChar(46+46,10,2,colors[2],colors[7],2);      //液
  48   1          ChineseChar(78+46,10,2,colors[2],colors[7],3);      //心
  49   1          ChineseChar(110+46,10,2,colors[2],colors[7],4);     //伤
  50   1              //---------------------------------
  51   1          ChineseChar( 0,60,1,colors[0],colors[7],1);     //靠
  52   1          ChineseChar(24,60,1,colors[0],colors[7],2);     //!
  53   1          
  54   1          ChineseChar( 48,60,1,colors[1],colors[7],3);    //
C51 COMPILER V7.50   MAIN                                                                  02/15/2014 16:19:27 PAGE 2   

  55   1          ChineseChar( 72,60,1,colors[2],colors[7],4);    //
  56   1          ChineseChar( 96,60,1,colors[3],colors[2],5);    //
  57   1          ChineseChar(120,60,1,colors[4],colors[7],6);        //
  58   1          ChineseChar(144,60,1,colors[5],colors[7],7);        //
  59   1          ChineseChar(168,60,1,colors[6],colors[7],8);        //
  60   1          ChineseChar(192,60,1,colors[5],colors[2],9);        //片
  61   1              //---------------------------------
  62   1          ChineseChar( 0,90,1,colors[4],colors[7],10);    //
  63   1              ChineseChar(24,90,1,colors[4],colors[7],11);    //
  64   1              ChineseChar(48,90,1,colors[6],colors[7],12);    //
  65   1              ChineseChar(72,90,1,colors[6],colors[7],13);    //
  66   1              
  67   1              ChineseChar( 96,90,1,colors[2],colors[7],14);   //
  68   1              ChineseChar(120,90,1,colors[2],colors[7],15);   //
  69   1              ChineseChar(144,90,1,colors[2],colors[7],16);   //
  70   1              ChineseChar(168,90,1,colors[4],colors[7],17);   //
  71   1              ChineseChar(192,90,1,colors[4],colors[7],18);   //
  72   1              //---------------------------------
  73   1          ChineseChar( 0,120,1,colors[4],colors[7],19);   //
  74   1              ChineseChar(24,120,1,colors[5],colors[2],20);   //
  75   1              ChineseChar(48,120,1,colors[5],colors[2],21);   //
  76   1              ChineseChar(72,120,1,colors[5],colors[2],22);   //
  77   1              
  78   1              ChineseChar( 96,120,1,colors[2],colors[7],23);  //
  79   1              ChineseChar(120,120,1,colors[2],colors[7],24);  //
  80   1              ChineseChar(144,120,1,colors[2],colors[7],25);  //
  81   1              ChineseChar(168,120,1,colors[4],colors[7],26);  //
  82   1              ChineseChar(192,120,1,colors[4],colors[7],27);  //
  83   1              //---------------------------------
  84   1          ChineseChar( 0,150,1,colors[4],colors[7],28);   //
  85   1              ChineseChar(24,150,1,colors[1],colors[7],29);   //
  86   1              ChineseChar(48,150,1,colors[2],colors[7],30);   //
  87   1              ChineseChar(72,150,1,colors[3],colors[2],31);   //
  88   1              
  89   1              ChineseChar( 96,150,1,colors[2],colors[7],32);  //?
  90   1              //---------------------------------
  91   1          
  92   1          //LCD_ShowString(12,60,colors[0],colors[7],"-");
  93   1          //LCD_ShowString(0,90,colors[0],colors[5],"WWW.PRINTER.com");
  94   1          //LCD_ShowString(216,120,colors[4],colors[7],":");
  95   1          
  96   1              LCD_ShowString(0,180,colors[7],colors[2],"www.s6d0154.com");//www.s6d0154.com.net若超出字符不予显示
  97   1          //LCD_ShowString(12,180,colors[0],colors[7],"TELL:");
  98   1          
  99   1          LCD_ShowString(0,210,colors[2],colors[7],"T: 010-12345678");        
 100   1          LCD_ShowString(0,240,colors[2],colors[7],"abcdefJhiJKLMNOP"); 
 101   1          LCD_ShowString(0,265,colors[2],colors[7],"pqrstuvwxyz!@#$"); 
 102   1          LCD_ShowString(0,290,colors[2],colors[7],"<>CDEF^&*()/,[]");
 103   1          //---------------------------------
 104   1              LCD_CS =1;  //关闭片选使能
 105   1      }
 106          //******************************************************************
 107          //  主程序
 108          //------------------------------------------------------------------
 109          void TestDelay(uchar timer)
 110          {
 111   1      //  uint DelayTime;
 112   1      
 113   1        etx0=0;
 114   1        TH0=T0_H;
 115   1        TL0=T0_L;
 116   1        if (1==timer)
C51 COMPILER V7.50   MAIN                                                                  02/15/2014 16:19:27 PAGE 3   

 117   1        {
 118   2          TR0=1;
 119   2          Delay(1);
 120   2          TR0=0;
 121   2        }
 122   1        else
 123   1        {
 124   2          TR0=1;
 125   2          delayms(1);
 126   2          TR0=0;
 127   2        }
 128   1      //  DelayTime=(TH0<<8)|TL0;
 129   1        SerialSend(etx0,2);
 130   1      }
 131          
 132          unsigned int etx0;
 133          uchar Display[16]={0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
 134                             0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00};
 135          void HEXtoASC(uint HEX, uchar index)
 136          {
 137   1        uchar i, temp;
 138   1        for (i=4;i!=0;i--)
 139   1        {
 140   2          if (4==i)
 141   2                temp=HEX>>12;
 142   2          else if (3==i)
 143   2                temp=HEX>>8;
 144   2          else if (2==i)
 145   2                temp=((uchar)HEX)>>4;
 146   2              else
 147   2                temp=HEX;
 148   2              temp&=0x0f;
 149   2              if (temp>9)
 150   2                Display[index]=temp+'A'-10;
 151   2              else
 152   2                Display[index]=temp+'0';
 153   2              index++;
 154   2        }
 155   1      }
 156          
 157          void main(void)
 158          {
 159   1      //    uint DelayTime;
 160   1      
 161   1              InitSys();//初始化timer/serial-isp
 162   1          //---------------------------------
 163   1          LCD_Init();//-yuan
 164   1          /*
 165   1                  //---------------------------------
 166   1                  Pant(0xff,0xff);  //TFT清屏
 167   1                  Delay(100);
 168   1                  //---------------------------------
 169   1                  Display_Image();
 170   1                  Delay(2000);
 171   1                  //while(1);
 172   1          */
 173   1                  ViewTFT();          //在TFT上显示字符
 174   1                  Delay(3000);
 175   1                  //while(1);
 176   1                  
 177   1          while(1)
 178   1          {
C51 COMPILER V7.50   MAIN                                                                  02/15/2014 16:19:27 PAGE 4   

 179   2              Display_White();
 180   2              Delay(400);
 181   2              Display_Black();
 182   2              Delay(400);
 183   2      
 184   2              etx0=0;
 185   2              TH0=T0_H;
 186   2              TL0=T0_L;
 187   2              TR0=1;
 188   2              Display_Red();
 189   2              TR0=0;
 190   2      //        DelayTime=(etx0<<8);
 191   2      //              DelayTime|=(etx0>>8);
 192   2              SerialSend(etx0,2);
 193   2                      HEXtoASC(etx0, 0);
 194   2              Delay(400);
 195   2      
 196   2              Display_Green();
 197   2              Delay(400);
 198   2              Display_Blue();
 199   2              Delay(400);
 200   2      
 201   2              etx0=0;
 202   2              TH0=T0_H;
 203   2              TL0=T0_L;
 204   2              TR0=1;
 205   2              Pant(0x0,0x0);    //TFT黑色清屏
 206   2              TR0=0;
 207   2      //        DelayTime=(etx0<<8);
 208   2      //              DelayTime|=(etx0>>8);
 209   2              SerialSend(etx0,2);
 210   2                      HEXtoASC(etx0, 5);
 211   2              Delay(400);
 212   2              //---------------------------------
 213   2      //        while(1)
 214   2              {
 215   3                  Pant(0xff,0xff);    //TFT白色清屏
 216   3                  Delay(400);
 217   3                  etx0=0;
 218   3                  TH0=T0_H;
 219   3                  TL0=T0_L;
 220   3                  TR0=1;
 221   3                  Display_Image();    //显示图片240*80
 222   3                  TR0=0;
 223   3      //            DelayTime=(etx0<<8);
 224   3      //                      DelayTime|=(etx0>>8);
 225   3                  SerialSend(etx0,2);
 226   3                          HEXtoASC(etx0, 10);
 227   3                  LCD_CS =0;  //打开片选使能
 228   3                  LCD_ShowString(0,296,colors[7],colors[4],Display);
 229   3                  LCD_CS =1;  //关闭片选使能
 230   3                  Delay(2000);
 231   3                  //---------------------------------
 232   3      //            Pant(0xff,0xff);  //不清屏的话就在上幅Image上覆盖
 233   3      //            Delay(500);
 234   3                              TestDelay(1);
 235   3                  ViewTFT();          //在TFT上显示字符
 236   3                  Delay(2000);
 237   3                          TestDelay(2);
 238   3              }
 239   2          }
 240   1      }
C51 COMPILER V7.50   MAIN                                                                  02/15/2014 16:19:27 PAGE 5   

 241          //while(1){Delay(500);PWM0=~PWM0;}
 242          //******************************************************************
 243          //  
 244          //------------------------------------------------------------------
 245          
 246          //---------------------------------
 247          
 248          //******************************************************************
 249          //  
 250          //------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1642    ----
   CONSTANT SIZE    =     81    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     18    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
