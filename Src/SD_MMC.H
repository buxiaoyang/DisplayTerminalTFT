/*****************************************************************************

                               SD卡驱动程序
                            (裁剪版，只读不写）

*****************************************************************************/
#ifndef	_SD_MMC_
#define _SD_MMC_
/************************ 定义引脚 *************************/
sbit MISO = P4^3;  //SD卡数据输出
sbit CLK  = P4^2;  //SD卡时钟输入
sbit MOSI = P4^1;  //SD卡数据输入
sbit CS   = P4^0;  //SD卡片选使能

/*********************** 全局变量 **************************/

/********************** 写入一个字节 ***********************/
void SD_write_byte(unsigned char dat);
/********************* 慢速写入一个字节 *********************/
void SD_write_byte_low_speed(unsigned char x);
/******************** 利用硬件移入一字节 ********************/
unsigned char SD_spi_read(void);
/********************** 慢速读入一字节 ***********************/
unsigned char SD_read_byte_low_speed(void);
/************************ 读入一字节 *************************/
unsigned char SD_read_byte(void);
/********************* SD卡访问出错处理 **********************/
void Error(unsigned char Err_code);
/************************ 等待SD响应 *************************/
void Wait_start_token(void);
/*********************** 跳过不需要的数据 ********************/
void Skip_nwords(unsigned char n);
/******************* SD读入n个字节数据 ***********************/
void Read_nbytes(unsigned char n);
/********************** SD卡 复位，激活 **********************/
unsigned char SD_init(void);
/************************ 设置块大小 ************************/
void Set_block_size(unsigned char size);
/*********************** 发送块读命令 ************************/
void SD_send_read_cmd(void);
/********************* 结束块读操作 **************************/
void SD_read_block_complete(void);

#endif // _SD_MMC_